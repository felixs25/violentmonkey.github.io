<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/component---src-templates-post-template-js.292cc1b7dc913b349885.css">.menu{position:fixed;top:0;left:0;right:0;padding:0 1rem;background:#fff;border-bottom:.0625rem solid #dcdcdc}.menu-logo{float:left;padding:.5rem}.menu-logo img{height:3rem}.menu-list{float:right;list-style:none;padding:0;margin:1.5rem 0 0}.menu-list-item{display:inline-block;padding:0;margin:0 .625rem}.menu-list-item-link{font-size:1rem;color:#222;font-weight:400;border:0}.menu-list-item-link:focus,.menu-list-item-link:hover{color:#5d93ff;border-bottom:.0625rem solid #5d93ff}.menu-list-item-link.active{color:#222;border-bottom:.0625rem solid #222}.footer{padding:1.5rem;border-top:.0625rem solid #ddd}.footer-copyright{float:left}.footer-list{float:right}.footer-list-item{display:inline-block;list-style:none}

/*! normalize.css v8.0.1 | MIT License | github.com/necolas/normalize.css */html{line-height:1.15;-webkit-text-size-adjust:100%}body{margin:0}main{display:block}h1{font-size:2em;margin:.67em 0}hr{box-sizing:content-box;height:0;overflow:visible}pre{font-family:monospace,monospace;font-size:1em}a{background-color:transparent}abbr[title]{border-bottom:none;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}b,strong{font-weight:bolder}code,kbd,samp{font-family:monospace,monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0}button,input{overflow:visible}button,select{text-transform:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:.0625rem dotted ButtonText}fieldset{padding:.35em .75em .625em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}progress{vertical-align:baseline}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-.125rem}[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}details{display:block}summary{display:list-item}[hidden],template{display:none}code[class*=language-],pre[class*=language-]{color:#000;background:none;text-shadow:0 .0625rem #fff;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}code[class*=language-]::-moz-selection,code[class*=language-] ::-moz-selection,pre[class*=language-]::-moz-selection,pre[class*=language-] ::-moz-selection{text-shadow:none;background:#b3d4fc}code[class*=language-]::selection,code[class*=language-] ::selection,pre[class*=language-]::selection,pre[class*=language-] ::selection{text-shadow:none;background:#b3d4fc}@media print{code[class*=language-],pre[class*=language-]{text-shadow:none}}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#f5f2f0}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#708090}.token.punctuation{color:#999}.namespace{opacity:.7}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#905}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#690}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url{color:#9a6e3a;background:hsla(0,0%,100%,.5)}.token.atrule,.token.attr-value,.token.keyword{color:#07a}.token.class-name,.token.function{color:#dd4a68}.token.important,.token.regex,.token.variable{color:#e90}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}body{font-family:Roboto,Helvetica Neue,Helvetica,Arial,sans-serif;color:#333;line-height:1.5}h1,h2,h3,h4,h5,h6{font-weight:500}h1{margin-top:3.75rem;font-size:2.5rem}h2{margin-top:2.5rem;font-size:1.6875rem}.autolink-fix h2{padding-top:5rem;margin-top:-3.75rem}h3{margin-top:2.5rem;font-size:1.375rem}.autolink-fix h3{padding-top:5rem;margin-top:-3.75rem}h4{margin-top:1.25rem;font-size:1.2rem}.autolink-fix h4{padding-top:5rem;margin-top:-5rem}h5{margin-top:1rem;font-size:1rem}.autolink-fix h5{padding-top:5rem;margin-top:-5.25rem}h6{margin-top:1rem;font-size:1rem}.autolink-fix h6{padding-top:5rem;margin-top:-5.25rem}ul{list-style:square;margin-bottom:1.25rem}ul li{padding:0 .3125rem;margin-bottom:.625rem}a{color:#5d93ff;text-decoration:none}a:hover{color:#f7a046}hr{width:6.25rem;height:.25rem;margin:3.75rem auto;border:none;background:#666}img{display:block;max-width:100%}details{padding:.5rem 1rem;border:.0625rem solid #ddd;border-radius:.5rem}.clearfix:after{content:"";display:block;clear:both}.label{padding:.25rem .5rem;color:#3498db;font-size:.75rem;border:.0625rem solid;border-radius:1rem}.layout{max-width:66.875rem;margin:0 auto}.content{margin-top:4.0625rem;padding:1.5625rem 1.25rem}@media screen and (min-width:685px){.content{padding:1.875rem 1.25rem}}@media screen and (min-width:960px){.content{padding:2.5rem 2.1875rem}}.page-title{max-width:40rem;margin:0 auto 2.5rem;font-size:2rem;font-weight:500;line-height:1;text-align:center}@media screen and (min-width:960px){.page-title{font-size:3rem}}.page-body{font-size:1rem}.post{max-width:59.0625rem;padding:0 .9375rem;margin:0 auto}.post-wrap{flex:1}.post-title{font-size:2rem;max-width:40rem;margin-left:auto;margin-right:auto;font-weight:600;text-align:center}.post-body figure blockquote{font-style:italic;text-align:center;margin-top:0}.post-body figure blockquote p{max-width:40rem;font-size:1.6817rem;margin-top:0}.post-body a{text-decoration:underline}.post-body .gatsby-highlight{max-width:40rem;margin-left:.9375rem;margin-right:.9375rem}.post-body :not(div):not(a){max-width:40rem;margin-left:auto;margin-right:auto}.post-footer{max-width:40rem;margin:1.25rem .9375rem 2.5rem}.post-footer-text a{text-decoration:underline}.post-date{max-width:40rem;margin-left:auto;margin-right:auto}.post-tags-list{list-style:none;margin:0 -.3125rem;padding:0}.post-tags-list-item{display:inline-block;margin:.625rem .3125rem}.post-tags-list-item-link{background:#e9e9e9;text-decoration:none;border:0;border-radius:.1875rem;color:#4e4e4e;line-height:1.625;padding:.5rem 1rem}.post-tags-list-item-link:focus,.post-tags-list-item-link:hover{color:#222;background:#ddd;border:0}.post-home-button{display:block;margin-left:auto;margin-right:auto;max-width:5.625rem;font-size:1rem;padding:0 1rem;height:2.1875rem;line-height:2.1875rem;text-align:center;color:#4e4e4e;background:#e9e9e9;font-weight:400;border-radius:.1875rem}.post-home-button:focus,.post-home-button:hover{color:#222;background:#ddd;border:0}@media screen and (min-width:685px){.post-body .gatsby-highlight,.post-footer{margin-left:auto;margin-right:auto}}@media screen and (min-width:960px){.post-inner{padding:0}.post-title{margin-top:3.75rem;font-size:3rem}.post-body,.post-body p{font-size:1.125rem}.post-home-button{position:fixed;max-width:none;margin:0;top:1.875rem;left:1.875rem}}</style><meta name="generator" content="Gatsby 2.0.60"/><style type="text/css">
    .anchor {
      float: left;
      padding-right: 4px;
      margin-left: -20px;
    }
    h1 .anchor svg,
    h2 .anchor svg,
    h3 .anchor svg,
    h4 .anchor svg,
    h5 .anchor svg,
    h6 .anchor svg {
      visibility: hidden;
    }
    h1:hover .anchor svg,
    h2:hover .anchor svg,
    h3:hover .anchor svg,
    h4:hover .anchor svg,
    h5:hover .anchor svg,
    h6:hover .anchor svg,
    h1 .anchor:focus svg,
    h2 .anchor:focus svg,
    h3 .anchor:focus svg,
    h4 .anchor:focus svg,
    h5 .anchor:focus svg,
    h6 .anchor:focus svg {
      visibility: visible;
    }
  </style><script>
    document.addEventListener("DOMContentLoaded", function(event) {
      var hash = window.decodeURI(location.hash.replace('#', ''))
      if (hash !== '') {
        var element = document.getElementById(hash)
        if (element) {
          var offset = element.offsetTop
          // Wait for the browser to finish rendering before scrolling.
          setTimeout((function() {
            window.scrollTo(0, offset - 0)
          }), 0)
        }
      }
    })
  </script><link rel="sitemap" type="application/xml" href="/sitemap.xml"/><link rel="manifest" href="/manifest.webmanifest"/><title data-react-helmet="true">Smart rules for blacklist - Violentmonkey</title><link data-react-helmet="true" rel="shortcut icon" type="image/png" href="/static/vm-e0d9ed50fb982761b0f7cdea8b093ae9.png"/><meta data-react-helmet="true" name="description" content=""/><link as="script" rel="preload" href="/component---src-templates-post-template-js-6e5569ac4752bc16d339.js"/><link as="script" rel="preload" href="/app-2605c32fefb53af6bef3.js"/><link as="script" rel="preload" href="/1-c02f62750d411541b0e4.js"/><link as="script" rel="preload" href="/0-b1c1824f5a88f8dcfc23.js"/><link as="script" rel="preload" href="/webpack-runtime-f402c11c5bdc025deeda.js"/><link rel="preload" href="/static/d/311/path---2017-04-15-smart-rules-for-blacklist-8-b-4-50a-Xo1xlM2pwfSX0afOd2yVVu9boPk.json" as="fetch" crossOrigin="use-credentials"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" role="group"><div class="layout "><div class="post-wrap"><div><a class="post-home-button" href="/posts/">All Articles</a></div><div class="post"><h1 class="post-title">Smart rules for blacklist</h1><div class="post-body"><p>Userscripts are injected into web pages according to predefined rules. However, the rules do not always satisfy users for different reasons. In such cases, we need blacklist to exclude some web pages for all scripts.</p>
<h3 id="blacklist-use-cases"><a href="#blacklist-use-cases" aria-hidden class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Blacklist use cases</h3>
<ul>
<li>
<p>hostnames</p>
<p>In most cases, we may want to add simply hostnames to exclude.</p>
</li>
<li>
<p><code class="language-text">@exclude-match</code> rules</p>
<p>Since match patterns are safer to match URLs, we prefer to use <code class="language-text">@exclude-match</code> rules to exclude URLs more flexibly.</p>
</li>
<li>
<p><code class="language-text">@exclude</code> rules</p>
<p>They are commonly supported by userscripts, so we should just keep them work.</p>
</li>
</ul>
<h3 id="blacklist-patterns"><a href="#blacklist-patterns" aria-hidden class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Blacklist patterns</h3>
<p>Taken all use cases into account, the blacklist may have following patterns:</p>
<ul>
<li>
<p>hostnames</p>
<p>A string without slashes, e.g. <code class="language-text">example.com</code>, <code class="language-text">*.example.com</code>.</p>
</li>
<li>
<p><a href="https://developer.chrome.com/extensions/match_patterns">match patterns</a></p>
<p>A string with scheme, hostname and pathname patterns, e.g. <code class="language-text">*://*/*</code>, <code class="language-text">https://www.google.com/</code>.</p>
</li>
<li>
<p><a href="https://wiki.greasespot.net/Include_and_exclude_rules"><code class="language-text">@exclude</code> rules</a></p>
<p>A string prefixed with <code class="language-text">@exclude</code>, e.g. <code class="language-text">@exclude https://*</code>.</p>
</li>
<li>
<p>comments</p>
<p>A string starting with <code class="language-text">#</code>, will be ignored.</p>
</li>
</ul>
<p>Here is a full example for blacklist:</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text"># hostnames
www.google.com

# @exclude-match rules
*://twitter.com/*

# @exclude rules
@exclude https://example.com/*</code></pre></div>
<h3 id="whitelist-patterns"><a href="#whitelist-patterns" aria-hidden class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Whitelist patterns</h3>
<p>For some people who want to disable Violentmonkey for most websites, a whitelist is needed.</p>
<p>To work as a whitelist, we can use following patterns:</p>
<ul>
<li>
<p><a href="https://developer.chrome.com/extensions/match_patterns"><code class="language-text">@match</code> rules</a></p>
<p>A string prefixed with <code class="language-text">@match</code>, and followed by a match pattern, e.g. <code class="language-text">@match https://www.google.com/*</code>.</p>
</li>
<li>
<p><a href="https://wiki.greasespot.net/Include_and_exclude_rules"><code class="language-text">@include</code> rules</a></p>
<p>A string prefixed with <code class="language-text">@include</code>, e.g. <code class="language-text">@include https://*</code>.</p>
</li>
</ul>
<p>If any of the rules above are matched, the URL bypasses the blacklist.
To make it a whitelist, we should block all other URLs by a rule at the end: <code class="language-text">*</code>.</p>
<p>Here is a full example for whitelist:</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text"># match rules
@match https://www.google.com/*

# include rules
@include https://example.com/*

# block everything else
*</code></pre></div></div><div class="post-date"><em>Published at<!-- --> <!-- -->16 Apr 2017</em></div><div class="post-footer"><div class="post-tags"><ul class="post-tags-list"><li class="post-tags-list-item"><a class="post-tags-list-item-link" href="/tags/blacklist/">blacklist</a></li><li class="post-tags-list-item"><a class="post-tags-list-item-link" href="/tags/exclude/">exclude</a></li><li class="post-tags-list-item"><a class="post-tags-list-item-link" href="/tags/match/">match</a></li></ul></div><div></div></div></div></div></div></div></div><script>
  
  
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'UA-93752732-1', 'auto', {});
      
      }
      </script><script id="gatsby-script-loader">/*<![CDATA[*/window.page={"componentChunkName":"component---src-templates-post-template-js","jsonName":"2017-04-15-smart-rules-for-blacklist-8b4","path":"/2017/04/15/Smart-rules-for-blacklist/"};window.dataPath="311/path---2017-04-15-smart-rules-for-blacklist-8-b-4-50a-Xo1xlM2pwfSX0afOd2yVVu9boPk";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-2605c32fefb53af6bef3.js"],"component---node-modules-gatsby-plugin-offline-app-shell-js":["/component---node-modules-gatsby-plugin-offline-app-shell-js-93d2466c865662915fb8.js"],"component---src-templates-posts-template-js":["/component---src-templates-posts-template-js.9f78f49edb8cb24613e0.css","/component---src-templates-posts-template-js-9a0e63ddabf738a57403.js"],"component---src-templates-post-template-js":["/component---src-templates-post-template-js.292cc1b7dc913b349885.css","/component---src-templates-post-template-js-6e5569ac4752bc16d339.js"],"component---src-templates-tag-template-js":["/component---src-templates-tag-template-js.148e7d32643112724ddd.css","/component---src-templates-tag-template-js-4eb146a0eab2fcd3c2ed.js"],"component---src-templates-category-template-js":["/component---src-templates-category-template-js.148e7d32643112724ddd.css","/component---src-templates-category-template-js-60c649f6afe29c7a44ed.js"],"component---src-templates-page-template-js":["/component---src-templates-page-template-js.333695171054c2d7aca9.css","/component---src-templates-page-template-js-8a06e3490fad44dfdccb.js"],"component---src-pages-404-js":["/component---src-pages-404-js.36317b1178ea991b5e26.css","/component---src-pages-404-js-7aad93d939240b6b80d7.js"],"component---src-pages-categories-js":["/component---src-pages-categories-js-4915d39e288ea4e43357.js"],"component---src-pages-donate-js":["/component---src-pages-donate-js.2a47145bc0ca4233807c.css","/component---src-pages-donate-js-88457e01d704ccdf7393.js"],"component---src-pages-index-js":["/component---src-pages-index-js.df1766b689c8d0830023.css","/component---src-pages-index-js-20f3b65811127ac11a85.js"],"component---src-pages-tags-js":["/component---src-pages-tags-js-dbf9be5392b0afc60a32.js"]};/*]]>*/</script><script src="/webpack-runtime-f402c11c5bdc025deeda.js" async=""></script><script src="/0-b1c1824f5a88f8dcfc23.js" async=""></script><script src="/1-c02f62750d411541b0e4.js" async=""></script><script src="/app-2605c32fefb53af6bef3.js" async=""></script><script src="/component---src-templates-post-template-js-6e5569ac4752bc16d339.js" async=""></script></body></html>